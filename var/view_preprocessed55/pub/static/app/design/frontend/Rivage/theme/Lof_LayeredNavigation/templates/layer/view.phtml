<?php if ($block->canShowBlock()): ?> <div class="block filter lof-layeredNavigation" id="layered-filter-block" ><?php $filtered = count($block->getLayer()->getState()->getFilters()) ?> <div class="block-title filter-title" data-count="<?php /* @escapeNotVerified */ echo $filtered; ?>"><strong data-role="title"><?php /* @escapeNotVerified */ echo __('FILTER') ?></strong></div><div class="block-content filter-content lof"><?php echo $block->getChildHtml('state') ?> <?php if ($block->getLayer()->getState()->getFilters()): ?> <div class="block-actions filter-actions "><a href="<?php /* @escapeNotVerified */ echo $block->getClearUrl() ?>" class="action clear filter-clear"><span><?php /* @escapeNotVerified */ echo __('Clear All') ?></span></a></div><?php endif; ?> <?php $activeKey = 0; $activeArray = []; ?> <div class="filter-options" id="narrow-by-list" data-role="content"><?php foreach ($block->getFilters() as $key => $filter): ?> <?php if ($filter->getItemsCount()): ?> <div class="filter-options-item"><div data-role="title" class="filter-options-title"><?php /* @escapeNotVerified */ echo __($filter->getName()) ?></div><div data-role="content" class="filter-options-content"><?php /* @escapeNotVerified */ echo $block->getChildBlock('renderer')->render($filter); ?></div></div><?php if($block->getRequest()->getParam($filter->getRequestVar())){ $activeArray[] = $activeKey; } $activeKey++; ?> <?php endif; ?> <?php endforeach; ?></div></div><script type="text/x-magento-init">
			{
				"#narrow-by-list": {
					"accordion": {
						"openedState": "active",
						"collapsible": true,
						"active": <?php echo sizeof($activeArray) ? $this->helper('Magento\Framework\Json\Helper\Data')->jsonEncode($activeArray) : 'false' ?>,
						"multipleCollapsible": true
					},
					"Lof_LayeredNavigation/js/layer": {}
				}
			}</script><div id="lof_overlay" class="lof_overlay"><img src="<?php /* @escapeNotVerified */ echo $block->getViewFileUrl('images/loader-1.gif'); ?>" alt="Loading..."></div></div><?php endif; ?>