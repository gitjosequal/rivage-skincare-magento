<?php if ($this->getBestsellerProduct() && $this->getBestsellerProduct()->getPageSize()) { $fetProdCollection = $this->getBestsellerProduct(); $productcount = $this->getProductLimit(); $imagewidth = $this->getProductimagewidth(); $imageheight = $this->getProductimageheight(); $widgetType = $this->getWidgettype(); $showCart = true; $mode = 'grid'; $title = __('Best Seller'); $type = 'widget-bestseller-grid'; $image = 'bestseller_products_content_widget_grid'; $templateType = \Magento\Catalog\Block\Product\ReviewRendererInterface::SHORT_VIEW; $objectManager = \Magento\Framework\App\ObjectManager::getInstance(); $enable = $objectManager->get('Magento\Framework\App\Config\ScopeConfigInterface')->getValue('imageflipper/setting/enable'); $storeManager = $objectManager->get('\Magento\Store\Model\StoreManagerInterface'); ?> <div class="block widget block-bestseller-products <?php /* @escapeNotVerified */ echo $mode; ?>"><div class="block-content"><div class="products-<?php /* @escapeNotVerified */ echo $mode; ?> <?php /* @escapeNotVerified */ echo $mode; ?>"><ol class="<?php echo ($widgetType == 'page') ? 'row' : 'owl-carousel owl-carousel2'; ?> product-items <?= /* @noEscape */ $type ?>"><?php $iterator = 1; ?> <?php foreach ($fetProdCollection as $item): $prod = $block->loadProduct($item->getProductId()); if($prod->getstatus() == 1): ?> <li class="product-item <?php echo ($widgetType == 'page') ? 'col-lg-3 col-md-6 col-sm-12' : ''; ?>"><div class="product-item-info"><?php $imageBlock = $block->getLayout()->createBlock('Magento\Catalog\Block\Product\ListProduct'); $productImage = $imageBlock->getImage($prod, 'category_page_grid'); ?> <a href="<?php /* @escapeNotVerified */ echo $prod->getProductUrl() ?>" class="product photo product-item-photo" tabindex="-1"><?php echo $productImage->toHtml();?></a> <div class="product-item-details"><strong class="product-item-name"><a title="<?php echo $block->escapeHtml($prod->getName()) ?>" href="<?php /* @escapeNotVerified */ echo $prod->getProductUrl() ?>" class="product-item-link"><?php echo $block->escapeHtml($prod->getName()) ?></a></strong> <div class="skintype"><?= $prod->getProductHint(); ?></div><div class="shordesc"><?= $prod->getShortDescription(); ?></div><?= $block->getReviewsSummaryHtml($prod, $templateType,true) ?> <?php echo $this->getProductPriceHtml($prod, $type); ?> <?php $flipper_img_name = $prod->getData('flipper_img'); if ($enable && $flipper_img_name) { $image_url=$storeManager->getStore()->getBaseUrl(\Magento\Framework\UrlInterface::URL_TYPE_MEDIA).'catalog/product'.$flipper_img_name; ?> <span id="magebees_fliper_img" style="display:none;"><?php echo $image_url;?></span> <?php } ?> <?php if ($showCart) : ?> <div class="product-item-inner"><div class="product-item-actions"><div class="actions-primary"><?php if ($prod->getIsSalable()) : ?> <?php $postParams = $block->getAddToCartPostParams($prod); ?> <form data-role="tocart-form" data-product-sku="<?= $block->escapeHtml($prod->getSku()) ?>" action="<?= $block->escapeUrl($postParams['action']) ?>" method="post"><input type="hidden" name="product" value="<?= $block->escapeHtmlAttr($postParams['data']['product']) ?>"><?= $block->getBlockHtml('formkey') ?> <input type="hidden" name="uenc" value="<?= $block->escapeHtmlAttr($postParams['data']['uenc']) ?>"><button type="submit" title="<?= $block->escapeHtml(__('ADD TO BAG')) ?>" class="action tocart primary"><span><?= $block->escapeHtml(__('ADD TO BAG')) ?></span></button></form><?php else : ?> <?php if ($prod->getIsSalable()) : ?> <div class="stock available"><span><?= $block->escapeHtml(__('In stock')) ?></span></div><?php else : ?> <div class="stock unavailable"><span><?= $block->escapeHtml(__('Out of stock')) ?></span></div><?php endif; ?> <?php endif; ?></div></div></div><?php endif; ?></div></div></li> <?php endif; endforeach; ?></ol></div></div></div><?php } ?>